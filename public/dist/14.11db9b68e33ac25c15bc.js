(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{n4gz:function(e,t,a){"use strict";a.r(t);var n=a("e7F3"),r=a("TJPC"),o=a("enAU");function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var d=a("wd/R");Object(n.c)("required",r.h),Object(n.c)("email",r.c),Object(n.c)("max",r.e),Object(n.c)("min",r.f),Object(n.c)("numeric",r.g),Object(n.c)("between",r.a),Object(n.d)("id",o);var l={components:{ValidationObserver:n.a,ValidationProvider:n.b},props:{uri:{type:String,required:!0},redirectUri:{type:String,required:!0},dataUri:{type:String,default:""},filter_client:{type:Array,default:function(){return[]}},filter_sales:{type:Array,default:function(){return[]}}},data:function(){var e,t;return i(t={unit_handover:[],field_state:!1,formAlert:!1,formAlertText:"",formAlertState:"info",date:(new Date).toISOString().substr(0,10),menu:!1,time:"",modal:!1,menu2:!1,menu3:!1,menu4:!1,menu5:!1,menu6:!1,datepicker:!1,items_approval:["Approved","Pending"],files:[{title:"Surat Hand Over",file_name:"handover_doc_file_name",url:"",showcase:""},{title:"Surat Hand Over Yang Sudah ditandatangani",file_name:"handover_doc_sign_name",url:"",showcase:""}]},"unit_handover",[]),i(t,"form_data",(i(e={handover_date:(new Date).toISOString().substr(0,10),payment_date:(new Date).toISOString().substr(0,10),unit_type:"",client_name:"",unit_number:"",surface_area:"",building_area:"",utj:"",electrical_power:"",points:"",closing_fee:"",total_amount:"",ppn:"",payment_type:"",payment_method:"",dp_amount:"",first_payment:"",principal:"",handover:"",time:"",due_date:"",amount:"",credits:"",payment_method_utj:"",bank_name:"",card_number:"",point:"",client_id:""},"client_name",""),i(e,"client_email",""),i(e,"client_phone_number",""),i(e,"client_mobile_number",""),i(e,"client_addres",""),i(e,"sales_id",""),i(e,"sales_name",""),i(e,"agency_name",""),i(e,"main_coordinator",""),i(e,"regional_coordinator",""),e)),t},computed:{},mounted:function(){this.setData()},methods:{setTime:function(e){this.$refs.menu.save(e),this.form_data.time=e},setData:function(){var e=this;this.dataUri&&(this.field_state=!0,axios.get(this.dataUri).then((function(t){if(t.data.success){var a,n=t.data.data;console.log(n);var r=[];e.form_data=(i(a={booking_id:n.id,ajb_date:n.ajb?n.ajb.ajb_date:null,unit_name:n.unit.unit_number+"/"+n.unit.unit_block,unit_type:n.unit.unit_type,unit_block:n.unit.unit_block,unit_number:n.unit.unit_number,closing_fee:e.moneyFormat(n.unit.closing_fee),total_amount:e.moneyFormat(n.total_amount),payment_type:n.payment_type,payment_date:n.tanggal_lunas_cicilan.payment_date,payment_method:n.payment_method,dp_amount:e.moneyFormat(n.dp_amount),first_payment:e.moneyFormat(n.first_payment),principal:e.moneyFormat(n.principal),handover:e.moneyFormat(n.handover),time:n.time,due_date:n.due_date,credits:e.moneyFormat(n.credits),amount:e.moneyFormat(n.amount),payment_method_utj:n.payment_method_utj,bank_name:n.bank_name,card_number:n.card_number,point:n.point,client_id:n.client_id,client_name:n.client.client_name,client_number:n.client.client_number,client_email:n.client.client_email,client_phone_number:n.client.client_phone_number,client_mobile_number:n.client.client_mobile_number,client_address:n.client.client_address,sales_id:n.sales_id,sales_name:n.sales.user.full_name,agency_name:n.sales.agency.agency_name,main_coordinator:n.sales.main_coordinator?n.sales.main_coordinator.full_name:"",regional_coordinator:n.sales.regional_coordinator?n.sales.regional_coordinator.full_name:"",handover_date:n.handover?n.handover.handover_date:null},"time",n.handover?e.reformatDateTime(n.handover.time,"HH:mm:ss","HH:mm"):null),i(a,"location",n.handover?n.handover.location:null),i(a,"address",n.handover?n.handover.address:null),i(a,"handover_doc_file_name",n.handover?n.handover.handover_doc_file_name:null),i(a,"handover_doc_sign_name",n.handover?n.handover.handover_doc_sign_name:null),i(a,"sign_upload",n.handover?n.handover.url_doc_file_name:""),i(a,"file_upload",n.handover?n.handover.url_doc_sign_file_name:""),i(a,"approval_client_status",n.handover?n.handover.approval_client_status:null),i(a,"approval_developer_status",n.handover?n.handover.approval_developer_status:null),i(a,"approval_notaris_status",n.handover?n.handover.approval_notaris_status:null),a),_.forEach(n.payments,(function(t,a){r.push({id:t.id,payment:t.payment,due_date:e.showFormattedDt(t.due_date),handover:e.moneyFormat(t.handover),credit:e.moneyFormat(t.credit)})})),e.unit_handover=r,e.time=e.reformatDateTime(n.handover.time,"HH:mm:ss","HH:mm"),e.field_state=!1}else e.formAlert=!0,e.formAlertState="error",e.formAlertText=t.data.message,e.field_state=!1})).catch((function(t){e.tableAlert=!0,e.tableAlertState="error",e.tableAlertText="Oops, something went wrong. Please try again later.",e.field_state=!1})))},submit:function(){var e=this;this.$refs.observer.validate().then((function(t){t&&e.postFormData()}))},postFormData:function(){var e=this,t=new FormData(this.$refs["post-form"]);this.dataUri&&(t.append("_method","put"),t.append("booking_id",this.form_data.booking_id),t.append("handover_date",this.form_data.handover_date),t.append("time",this.form_data.time)),this.field_state=!0,axios.post(this.uri,t).then((function(t){t.data.success?(e.formAlert=!0,e.formAlertState="success",e.formAlertText=t.data.message,setTimeout((function(){e.goto(e.redirectUri)}),6e3)):(e.formAlert=!0,e.formAlertState="error",e.formAlertText=t.data.message,e.field_state=!1)})).catch((function(t){e.tableAlert=!0,e.tableAlertState="error",e.tableAlertText="Oops, something went wrong. Please try again later.",e.field_state=!1}))},updatehandover:function(){var e=this;this.regeneratehandover();var t=new FormData(this.$refs["post-form"]);t.append("unit_handover",JSON.stringify(this.unit_handover)),this.dataUri&&t.append("_method","put"),this.field_state=!0,axios.post(this.uri,t).then((function(t){t.data.success?(e.formAlert=!0,e.formAlertState="success",e.formAlertText=t.data.message,setTimeout((function(){e.goto(e.redirectUri)}),6e3)):(e.formAlert=!0,e.formAlertState="error",e.formAlertText=t.data.message,e.field_state=!1)})).catch((function(t){e.tableAlert=!0,e.tableAlertState="error",e.tableAlertText="Oops, something went wrong. Please try again later.",e.field_state=!1}))},moneyFormat:function(e){var t=isFinite(+e)?+e:0,a=isFinite(0)?Math.abs(0):0,n=(a?function(e,t){var a=Math.pow(10,t);return Math.round(e*a)/a}(t,a):Math.round(t)).toString().split(".");return n[0].length>3&&(n[0]=n[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,".")),(n[1]||"").length<a&&(n[1]=n[1]||"",n[1]+=new Array(a-n[1].length+1).join("0")),n.join(",")},showFormattedDt:function(e){return d(e,"YYYY-MM-DD").format("DD-MMM-YYYY")},regeneratehandover:function(){var e=this,t=[],a=_.toString(this.unit_handover[0].credit).split(".").join(""),n=parseInt(a);_.forEach(this.unit_handover,(function(a,r){0==r?t.push({id:a.id,payment:a.payment,due_date:a.due_date,handover:e.moneyFormat(parseInt(_.toString(a.handover).split(".").join(""))),credit:e.moneyFormat(parseInt(_.toString(a.credit).split(".").join("")))}):(n-=parseInt(_.toString(a.handover).split(".").join("")),t.push({id:a.id,payment:a.payment,due_date:a.due_date,handover:r==e.form_data.time?e.moneyFormat(parseInt(_.toString(a.handover).split(".").join(""))+n):e.moneyFormat(parseInt(_.toString(a.handover).split(".").join(""))),credit:r==e.form_data.time?0:e.moneyFormat(n)}))})),this.unit_handover=t}}},m=a("KHd+"),s=Object(m.a)(l,void 0,void 0,!1,null,null,null);t.default=s.exports}}]);