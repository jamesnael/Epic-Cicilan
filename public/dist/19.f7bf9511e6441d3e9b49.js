(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{RNm6:function(e,t,n){"use strict";n.r(t);var a=n("e7F3"),i=n("TJPC"),r=n("enAU");function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n("wd/R");Object(a.c)("required",i.h),Object(a.c)("email",i.c),Object(a.c)("max",i.e),Object(a.c)("min",i.f),Object(a.c)("numeric",i.g),Object(a.c)("between",i.a),Object(a.d)("id",r);var s={components:{ValidationObserver:a.a,ValidationProvider:a.b},props:{uri:{type:String,required:!0},redirectUri:{type:String,required:!0},dataUri:{type:String,default:""},filter_client:{type:Array,default:function(){return[]}},filter_sales:{type:Array,default:function(){return[]}}},data:function(){var e;return{field_state:!1,formAlert:!1,formAlertText:"",formAlertState:"info",modal:!1,menu2:!1,menu:!1,datepicker:!1,unit_installments:[],form_data:(e={unit_type:"",client_name:"",unit_number:"",surface_area:"",building_area:"",utj:"",electrical_power:"",points:"",closing_fee:"",total_amount:"",ppn:"",payment_type:"",payment_method:"",dp_amount:"",first_payment:"",principal:"",installment:"",installment_time:"",due_date:"",amount:"",credits:"",payment_method_utj:"",bank_name:"",card_number:"",point:"",client_id:""},l(e,"client_name",""),l(e,"client_email",""),l(e,"client_phone_number",""),l(e,"client_mobile_number",""),l(e,"client_addres",""),l(e,"sales_id",""),l(e,"sales_name",""),l(e,"agency_name",""),l(e,"main_coordinator",""),l(e,"regional_coordinator",""),l(e,"nup_amount",""),l(e,"utj_amount",""),l(e,"payment_method_nup",""),l(e,"nup_date",""),l(e,"utj_date",""),l(e,"deal_closer",""),e)}},mounted:function(){this.setData()},methods:{setData:function(){var e=this;this.dataUri&&(this.field_state=!0,axios.get(this.dataUri).then((function(t){if(t.data.success){var n,a=t.data.data,i=[];_.forEach(a.payments,(function(e,t){e.table_index=parseInt(t)+1,i.push(e)})),e.form_data=(l(n={client_number:a.client.client_number,client_name:a.client.client_name,client_mobile_number:a.client.client_mobile_number,client_email:a.client.client_email,client_address:a.client.client_address,sales_name:a.sales.user.full_name,unit_type:a.unit.unit_type,unit_block:a.unit.unit_block,unit_number:a.unit.unit_number,surface_area:a.unit.surface_area,building_area:a.unit.building_area,electrical_power:a.unit.electrical_power,nup_amount:a.nup_amount,payment_method_nup:a.payment_method_nup,nup_date:a.nup_date,utj_amount:a.utj_amount,payment_method_utj:a.payment_method_utj,utj_date:a.utj_date,payment_type:a.payment_type,total_amount:a.total_amount,first_payment:a.first_payment,principal:a.principal,installment:a.installment,installment_time:a.installment_time,total_pembayaran:a.total_pembayaran,sisa_tunggakan:a.sisa_tunggakan,total_denda:a.total_denda,points:a.unit.points,closing_fee:e.moneyFormat(a.unit.closing_fee),bank_name:a.bank_name,card_number:a.card_number,client_id:a.client_id},"client_name",a.client.client_name),l(n,"client_number",a.client.client_number),l(n,"client_email",a.client.client_email),l(n,"client_phone_number",a.client.client_phone_number),l(n,"client_mobile_number",a.client.client_mobile_number),l(n,"client_address",a.client.client_address),l(n,"sales_id",a.sales_id),l(n,"sales_name",a.sales.user.full_name),l(n,"agency_name",a.sales.agency?a.sales.agency.agency_name:""),l(n,"main_coordinator",a.sales.main_coordinator?a.sales.main_coordinator.full_name:""),l(n,"regional_coordinator",a.sales.regional_coordinator?a.sales.regional_coordinator.full_name:""),l(n,"payments",i),l(n,"deal_closer",a.deal_closer),n),e.field_state=!1}else e.formAlert=!0,e.formAlertState="error",e.formAlertText=t.data.message,e.field_state=!1})).catch((function(t){e.tableAlert=!0,e.tableAlertState="error",e.tableAlertText="Oops, something went wrong. Please try again later.",e.field_state=!1})))},submit:function(){var e=this;this.$refs.observer.validate().then((function(t){t&&e.postFormData()}))},updateInstallment:function(){var e=this;this.regenerateInstallment();var t=new FormData(this.$refs["post-form"]);t.append("unit_installments",JSON.stringify(this.form_data.payments)),this.dataUri&&t.append("_method","put"),this.field_state=!0,axios.post(this.uri,t).then((function(t){t.data.success?(e.formAlert=!0,e.formAlertState="success",e.formAlertText=t.data.message,setTimeout((function(){e.goto(e.redirectUri)}),6e3)):(e.formAlert=!0,e.formAlertState="error",e.formAlertText=t.data.message,e.field_state=!1)})).catch((function(t){e.tableAlert=!0,e.tableAlertState="error",e.tableAlertText="Oops, something went wrong. Please try again later.",e.field_state=!1}))},moneyFormat:function(e){var t=isFinite(+e)?+e:0,n=isFinite(0)?Math.abs(0):0,a=(n?function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}(t,n):Math.round(t)).toString().split(".");return a[0].length>3&&(a[0]=a[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,".")),(a[1]||"").length<n&&(a[1]=a[1]||"",a[1]+=new Array(n-a[1].length+1).join("0")),a.join(",")},regenerateInstallment:function(){var e=this,t=[],n=this.form_data.payments[0].credit,a=parseInt(n);_.forEach(this.form_data.payments,(function(n,i){0==i||i==parseInt(e.form_data.installment_time)+1&&"KPR/KPA"==e.form_data.payment_type?t.push({id:n.id,payment:n.payment,due_date:n.due_date,installment:parseInt(n.installment),credit:parseInt(n.credit)}):(a=parseInt(a)-parseInt(n.installment),t.push({id:n.id,payment:n.payment,due_date:n.due_date,installment:i==e.form_data.installment_time?parseInt(n.installment)+parseInt(a):parseInt(n.installment),credit:i==e.form_data.installment_time?0:parseInt(a)}))})),this.form_data.payments=t}}},o=n("KHd+"),m=Object(o.a)(s,void 0,void 0,!1,null,null,null);t.default=m.exports}}]);