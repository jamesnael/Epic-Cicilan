(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"m+jS":function(e,t,r){"use strict";r.r(t);var a=r("e7F3"),i=r("TJPC"),n=r("enAU");Object(a.c)("required",i.h),Object(a.c)("email",i.c),Object(a.c)("max",i.e),Object(a.c)("min",i.f),Object(a.c)("numeric",i.g),Object(a.c)("between",i.a),Object(a.d)("id",n);var s={components:{ValidationObserver:a.a,ValidationProvider:a.b},props:{slug:{type:String,default:""},uri:{type:String,required:!0},redirectUri:{type:String,required:!0},dataUri:{type:String,default:""},deleteText:{type:String,default:"Delete"},deleteIcon:{type:String,default:"mdi-trash-can-outline"},deleteColor:{type:String,default:"red lighten-1"},deleteConfirmationText:{type:String,default:"Are you sure want to delete this file ?"},deleteCancelText:{type:String,default:"Cancel"}},data:function(){return{promptDelete:!1,field_state:!1,formAlert:!1,dialog:!1,deleteLoader:!1,formAlertText:"",formAlertState:"info",menu2:!1,menu3:!1,menu4:!1,modal:!1,form_data:{booking_id:"",client_name:"",sales_name:"",unit_name:"",print_date:(new Date).toISOString().substr(0,10),sent_date:(new Date).toISOString().substr(0,10),received_date:(new Date).toISOString().substr(0,10)},delete_file_type:"",cancel_reason:""}},mounted:function(){this.setData()},methods:{pairingUploadedUrl:function(e){_.forEach(this.files,(function(t){var r,a,i="url_"+t.file_name;t.url=null!==(r=e[i])&&void 0!==r?r:"",t.showcase=null!==(a=e[t.file_name])&&void 0!==a?a:""}))},setData:function(){var e=this;this.dataUri&&(this.field_state=!0,axios.get(this.dataUri).then((function(t){if(t.data.success){var r=t.data.data;e.form_data={booking_id:r.id,slug:r.slug,client_name:r.client.client_name,sales_name:r.sales.user.full_name,unit_name:r.unit.unit_number+"/"+r.unit.unit_block,print_date:r.spr?r.spr.print_date:null,print_date_data:r.spr?r.spr.print_date:null,sent_date:r.spr?r.spr.sent_date:null,sent_date_data:r.spr?r.spr.sent_date:null,received_date:r.spr?r.spr.received_date:null,received_date_data:r.spr?r.spr.received_date:null,approval_status:r.spr?r.spr.approval_status:null},e.pairingUploadedUrl(r.spr),e.field_state=!1}else e.formAlert=!0,e.formAlertState="error",e.formAlertText=t.data.message,e.field_state=!1})).catch((function(t){e.tableAlert=!0,e.tableAlertState="error",e.tableAlertText="Oops, something went wrong. Please try again later.",e.field_state=!1})))},submit:function(){var e=this;this.$refs.observer.validate().then((function(t){t&&e.postFormData()}))},clear:function(){this.form_data={},this.$refs.observer.reset()},postFormData:function(){var e=this,t=new FormData(this.$refs["post-form"]);this.dataUri&&(t.append("_method","put"),t.append("booking_id",this.form_data.booking_id),t.append("print_date",this.form_data.print_date),t.append("sent_date",this.form_data.sent_date),t.append("received_date",this.form_data.received_date)),this.field_state=!0,axios.post(this.uri,t).then((function(t){t.data.success?(e.formAlert=!0,e.formAlertState="success",e.formAlertText=t.data.message,setTimeout((function(){e.goto(e.redirectUri)}),6e3)):(e.formAlert=!0,e.formAlertState="error",e.formAlertText=t.data.message,e.field_state=!1)})).catch((function(t){e.tableAlert=!0,e.tableAlertState="error",e.tableAlertText="Oops, something went wrong. Please try again later.",e.field_state=!1}))},promptDeleteItem:function(e){this.promptDelete=!0,this.delete_file_type=e},removeUploadedFile:function(){var e=this,t=new FormData;axios.delete(this.base_url()+this.ziggy("spr.remove-file",[this.slug,this.delete_file_type]).url(),t).then((function(t){t.data.success?(e.formAlert=!0,e.formAlertState="success",e.formAlertText=t.data.message):(e.formAlert=!0,e.formAlertState="error",e.formAlertText=t.data.message),e.deleteLoader=!1,e.promptDelete=!1,e.setData()})).catch((function(t){e.formAlert=!0,e.formAlertState="error",e.formAlertText="Oops, something went wrong. Please try again later.",e.deleteLoader=!1,e.promptDelete=!1}))},cancelSpr:function(){var e=this,t=new FormData(this.$refs["put-form"]);t.append("_method","put"),t.append("reject_reason",this.cancel_reason),axios.post(this.base_url()+this.ziggy("spr.cancel",[this.form_data.slug]).url(),t).then((function(t){t.data.success?(e.formAlert=!0,e.formAlertState="success",e.formAlertText=t.data.message,setTimeout((function(){e.goto(e.redirectUri)}),3e3)):(e.formAlert=!0,e.formAlertState="error",e.formAlertText=t.data.message),e.deleteLoader=!1,e.promptDelete=!1,e.setData()})).catch((function(t){e.formAlert=!0,e.formAlertState="error",e.formAlertText="Oops, something went wrong. Please try again later.",e.deleteLoader=!1,e.promptDelete=!1}))}}},o=r("KHd+"),l=Object(o.a)(s,void 0,void 0,!1,null,null,null);t.default=l.exports}}]);