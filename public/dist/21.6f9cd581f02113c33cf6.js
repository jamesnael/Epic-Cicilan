(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{BEr5:function(t,e,a){"use strict";a.r(e);var n=a("e7F3"),i=a("TJPC"),r=a("enAU"),o=a("wd/R");Object(n.c)("required",i.g),Object(n.c)("email",i.b),Object(n.c)("max",i.d),Object(n.c)("min",i.e),Object(n.c)("numeric",i.f),Object(n.c)("between",i.a),Object(n.d)("id",r);var d={components:{ValidationObserver:n.a,ValidationProvider:n.b},props:{uri:{type:String,required:!0},redirectUri:{type:String,required:!0},dataUri:{type:String,default:""},filter_client:{type:Array,default:function(){return[]}},filter_sales:{type:Array,default:function(){return[]}}},data:function(){return{field_state:!1,formAlert:!1,formAlertText:"",formAlertState:"info",date:(new Date).toISOString().substr(0,10),menu:!1,modal:!1,menu2:!1,menu3:!1,menu4:!1,menu5:!1,menu6:!1,menu7:!1,dialog:!1,time:null,datepicker:!1,items_approval:["Approved","Pending"],form_data:{sales_name:"",sub_agent:"",koordinator_wilayah:"",koordinator_utama:"",total_point:"",sisa_point:"",reward_category:"",reward_point:"",redeem_point:""}}},computed:{},mounted:function(){this.setData()},methods:{setData:function(){var t=this;this.dataUri&&(this.field_state=!0,axios.get(this.dataUri).then((function(e){if(e.data.success){var a=e.data.data,n=[];t.form_data={unit_type:a.unit.unit_type,unit_block:a.unit.unit_block,unit_number:a.unit.unit_number,surface_area:a.unit.surface_area,building_area:a.unit.building_area,utj:a.unit.utj,electrical_power:a.unit.electrical_power,points:a.unit.points,closing_fee:t.moneyFormat(a.unit.closing_fee),total_amount:t.moneyFormat(a.total_amount),ppn:t.moneyFormat(a.ppn),payment_type:a.payment_type,payment_method:a.payment_method,dp_amount:t.moneyFormat(a.dp_amount),first_payment:t.moneyFormat(a.first_payment),principal:t.moneyFormat(a.principal),akad:t.moneyFormat(a.akad),akad_time:a.akad_time,due_date:a.due_date,credits:t.moneyFormat(a.credits),amount:t.moneyFormat(a.amount),payment_method_utj:a.payment_method_utj,bank_name:a.bank_name,card_number:a.card_number,point:a.point,client_id:a.client_id,client_name:a.client.client_name,client_number:a.client.client_number,client_email:a.client.client_email,client_phone_number:a.client.client_phone_number,client_mobile_number:a.client.client_mobile_number,client_address:a.client.client_address,sales_id:a.sales_id,sales_name:a.sales.user.full_name,agency_name:a.agency?a.agency.agency_name:"",main_coordinator:a.sales.main_coordinator?a.sales.main_coordinator.full_name:"",regional_coordinator:a.sales.regional_coordinator?a.sales.regional_coordinator.full_name:""},_.forEach(a.payments,(function(e,a){n.push({id:e.id,payment:e.payment,due_date:t.showFormattedDt(e.due_date),akad:t.moneyFormat(e.akad),credit:t.moneyFormat(e.credit)})})),t.unit_akad=n,t.field_state=!1}else t.formAlert=!0,t.formAlertState="error",t.formAlertText=e.data.message,t.field_state=!1})).catch((function(e){t.tableAlert=!0,t.tableAlertState="error",t.tableAlertText="Oops, something went wrong. Please try again later.",t.field_state=!1})))},submit:function(){var t=this;this.$refs.observer.validate().then((function(e){e&&t.postFormData()}))},updateAkad:function(){var t=this;this.regenerateAkad();var e=new FormData(this.$refs["post-form"]);e.append("unit_akad",JSON.stringify(this.unit_akad)),this.dataUri&&e.append("_method","put"),this.field_state=!0,axios.post(this.uri,e).then((function(e){e.data.success?(t.formAlert=!0,t.formAlertState="success",t.formAlertText=e.data.message,setTimeout((function(){t.goto(t.redirectUri)}),6e3)):(t.formAlert=!0,t.formAlertState="error",t.formAlertText=e.data.message,t.field_state=!1)})).catch((function(e){t.tableAlert=!0,t.tableAlertState="error",t.tableAlertText="Oops, something went wrong. Please try again later.",t.field_state=!1}))},moneyFormat:function(t){var e=isFinite(+t)?+t:0,a=isFinite(0)?Math.abs(0):0,n=(a?function(t,e){var a=Math.pow(10,e);return Math.round(t*a)/a}(e,a):Math.round(e)).toString().split(".");return n[0].length>3&&(n[0]=n[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,".")),(n[1]||"").length<a&&(n[1]=n[1]||"",n[1]+=new Array(a-n[1].length+1).join("0")),n.join(",")},showFormattedDt:function(t){return o(t,"YYYY-MM-DD").format("DD-MMM-YYYY")},regenerateAkad:function(){var t=this,e=[],a=_.toString(this.unit_akad[0].credit).split(".").join(""),n=parseInt(a);_.forEach(this.unit_akad,(function(a,i){0==i?e.push({id:a.id,payment:a.payment,due_date:a.due_date,akad:t.moneyFormat(parseInt(_.toString(a.akad).split(".").join(""))),credit:t.moneyFormat(parseInt(_.toString(a.credit).split(".").join("")))}):(n-=parseInt(_.toString(a.akad).split(".").join("")),e.push({id:a.id,payment:a.payment,due_date:a.due_date,akad:i==t.form_data.akad_time?t.moneyFormat(parseInt(_.toString(a.akad).split(".").join(""))+n):t.moneyFormat(parseInt(_.toString(a.akad).split(".").join(""))),credit:i==t.form_data.akad_time?0:t.moneyFormat(n)}))})),this.unit_akad=e}}},m=a("KHd+"),s=Object(m.a)(d,void 0,void 0,!1,null,null,null);e.default=s.exports}}]);