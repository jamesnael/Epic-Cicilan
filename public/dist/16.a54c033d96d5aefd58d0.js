(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"7nmR":function(e,t,a){"use strict";a.r(t);var n=a("e7F3"),r=a("TJPC"),i=a("enAU");function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a("wd/R");Object(n.c)("required",r.h),Object(n.c)("email",r.c),Object(n.c)("max",r.e),Object(n.c)("min",r.f),Object(n.c)("numeric",r.g),Object(n.c)("between",r.a),Object(n.d)("id",i);var l={components:{ValidationObserver:n.a,ValidationProvider:n.b},props:{uri:{type:String,required:!0},redirectUri:{type:String,required:!0},dataUri:{type:String,default:""},filter_payment_method:{type:Array,default:function(){return[]}}},data:function(){var e;return{loader:null,overlay:!1,progressText:"Mohon Menunggu.",unit_installments:[],field_state:!1,formAlert:!1,formAlertText:"",formAlertState:"info",dialog:!1,cancel_reason:"",modal:!1,idx:!1,menu:!1,menu2:!1,datepicker:!1,form_data:(e={unit_type:"",client_name:"",unit_number:"",surface_area:"",building_area:"",utj:"",electrical_power:"",points:"",closing_fee:"",total_amount:"",ppn:"",payment_type:"",payment_method:"",dp_amount:"",first_payment:"",principal:"",installment:"",installment_time:"",due_date:"",amount:"",credits:"",payment_method_utj:"",bank_name:"",card_number:"",point:"",client_id:""},o(e,"client_name",""),o(e,"client_email",""),o(e,"client_phone_number",""),o(e,"client_mobile_number",""),o(e,"client_addres",""),o(e,"sales_id",""),o(e,"sales_name",""),o(e,"agency_name",""),o(e,"main_coordinator",""),o(e,"regional_coordinator",""),o(e,"total_pembayaran",0),o(e,"sisa_tunggakan",0),o(e,"total_denda",0),o(e,"prosentase_pembayaran",0),o(e,"slug",""),o(e,"payment_method",""),o(e,"payment_date",""),o(e,"total_paid",""),o(e,"description",""),o(e,"payments",[]),e),paymentMethod:"",total:""}},mounted:function(){this.setData()},methods:{setData:function(){var e=this;this.dataUri&&(this.field_state=!0,axios.get(this.dataUri).then((function(t){if(t.data.success){var a,n=t.data.data,r=[];_.forEach(n.payments,(function(e,t){e.table_index=parseInt(t)+1,r.push(e)})),e.form_data=(o(a={client_number:n.client.client_number,client_name:n.client.client_name,client_mobile_number:n.client.client_mobile_number,client_email:n.client.client_email,client_address:n.client.client_address,sales_name:n.sales.user.full_name,unit_type:n.unit.unit_type,unit_block:n.unit.unit_block,unit_number:n.unit.unit_number,surface_area:n.unit.surface_area,building_area:n.unit.building_area,electrical_power:n.unit.electrical_power,nup_amount:n.nup_amount,payment_method_nup:n.payment_method_nup,nup_date:n.nup_date,utj_amount:n.utj_amount,payment_method_utj:n.payment_method_utj,utj_date:n.utj_date,payment_type:n.payment_type,total_amount:n.total_amount,first_payment:n.first_payment,principal:n.principal,installment:n.installment,installment_time:n.installment_time,total_pembayaran:n.total_pembayaran,sisa_tunggakan:n.sisa_tunggakan,total_denda:n.total_denda,prosentase_pembayaran:n.prosentase_pembayaran,sales_id:n.sales_id},"sales_name",n.sales.user.full_name),o(a,"agency_name",n.sales.agency?n.sales.agency.agency_name:""),o(a,"main_coordinator",n.sales.main_coordinator?n.sales.main_coordinator.full_name:""),o(a,"regional_coordinator",n.sales.regional_coordinator?n.sales.regional_coordinator.full_name:""),o(a,"payments",r),o(a,"slug",n.slug),a),e.field_state=!1}else e.formAlert=!0,e.formAlertState="error",e.formAlertText=t.data.message,e.field_state=!1})).catch((function(t){e.tableAlert=!0,e.tableAlertState="error",e.tableAlertText="Oops, something went wrong. Please try again later.",e.field_state=!1})))},moneyFormat:function(e){var t=isFinite(+e)?+e:0,a=isFinite(0)?Math.abs(0):0,n=(a?function(e,t){var a=Math.pow(10,t);return Math.round(e*a)/a}(t,a):Math.round(t)).toString().split(".");return n[0].length>3&&(n[0]=n[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,".")),(n[1]||"").length<a&&(n[1]=n[1]||"",n[1]+=new Array(a-n[1].length+1).join("0")),n.join(",")},postPayment:function(e){var t=this;this.$refs.observer.validate().then((function(a){if(a){t.field_state=!0;var n=new FormData(t.$refs["post-form"]);n.append("_method","put"),n.append("payment_method",t.form_data.payment_method),n.append("payment_date",t.form_data.payment_date),n.append("total_paid",t.form_data.total_paid),n.append("description",t.form_data.description?t.form_data.description:""),console.log(n),axios.post(t.base_url()+t.ziggy("manual-payment",[t.form_data.slug,e.slug]).url(),n).then((function(e){e.data.success?(t.formAlert=!0,t.formAlertState="success",t.formAlertText=e.data.message,t.field_state=!1,setTimeout((function(){window.location.reload()}),250)):(t.formAlert=!0,t.formAlertState="error",t.formAlertText=e.data.message,t.field_state=!1)})).catch((function(e){t.formAlert=!0,t.formAlertState="error",t.formAlertText="Oops, something went wrong. Please try again later.",t.field_state=!1}))}}))},setSelectedPayment:function(){var e=this,t=_.find(this.filter_payment_method,(function(t){return t.value==e.form_data.payment_method_id}));_.isUndefined(t)?this.form_data.payment_method="":this.form_data.payment_method=t.text},cancelInstallment:function(){var e=this,t=new FormData(this.$refs["put-form"]);t.append("_method","put"),t.append("reject_reason",this.cancel_reason),axios.post(this.base_url()+this.ziggy("installment-unit.cancel",[this.form_data.slug]).url(),t).then((function(t){t.data.success?(e.formAlert=!0,e.formAlertState="success",e.formAlertText=t.data.message,setTimeout((function(){e.goto(e.redirectUri)}),3e3)):(e.formAlert=!0,e.formAlertState="error",e.formAlertText=t.data.message),e.deleteLoader=!1,e.promptDelete=!1,e.setData()})).catch((function(t){e.formAlert=!0,e.formAlertState="error",e.formAlertText="Oops, something went wrong. Please try again later.",e.deleteLoader=!1,e.promptDelete=!1}))}}},s=a("KHd+"),m=Object(s.a)(l,void 0,void 0,!1,null,null,null);t.default=m.exports}}]);